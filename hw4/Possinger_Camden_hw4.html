<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STA 141C Homework 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw4_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw4_files/libs/quarto-html/quarto.js"></script>
<script src="hw4_files/libs/quarto-html/popper.min.js"></script>
<script src="hw4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw4_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA 141C Homework 4</h1>
<p class="subtitle lead">Camden Possinger</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="handwriting-recognition" class="level1">
<h1>1. Handwriting Recognition</h1>
<section id="question-1." class="level2">
<h2 class="anchored" data-anchor-id="question-1.">Question 1.</h2>
<p>Open ‘trainingMLE.R’ and obtain MLE estimators for each of the 10 handwriting digits (0, 1, 2, . . . , 9). (You may need to change the path when loading the data)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"trainingMLE.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  16  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -38197.2101571317"
[1] "iteration 2, logL = -37626.8316212697"
[1] "iteration 3, logL = -37416.9630075463"
[1] "iteration 4, logL = -37364.3217419136"
[1] "iteration 5, logL = -37358.5357607676"
[1] "iteration 6, logL = -37358.4201286343"
[1] "iteration 7, logL = -37358.4200651812"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  12  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -42393.2753225462"
[1] "iteration 2, logL = -42247.3790833947"
[1] "iteration 3, logL = -42192.892511791"
[1] "iteration 4, logL = -42183.8711723513"
[1] "iteration 5, logL = -42180.1409236255"
[1] "iteration 6, logL = -42179.2934904956"
[1] "iteration 7, logL = -42179.2456000791"
[1] "iteration 8, logL = -42179.2454225598"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  12  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -40274.084161804"
[1] "iteration 2, logL = -40032.0377685787"
[1] "iteration 3, logL = -39992.7406820426"
[1] "iteration 4, logL = -39986.6465223509"
[1] "iteration 5, logL = -39985.368264586"
[1] "iteration 6, logL = -39985.2651593761"
[1] "iteration 7, logL = -39985.2643117435"
[1] "iteration 8, logL = -39985.2643116789"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  11  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -40825.3731951663"
[1] "iteration 2, logL = -40559.6038767491"
[1] "iteration 3, logL = -40521.2911319022"
[1] "iteration 4, logL = -40519.4774633384"
[1] "iteration 5, logL = -40519.4708914076"
[1] "iteration 6, logL = -40519.4708911796"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  6  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -43771.7776546535"
[1] "iteration 2, logL = -43529.9141084289"
[1] "iteration 3, logL = -43491.7572999275"
[1] "iteration 4, logL = -43489.1158814316"
[1] "iteration 5, logL = -43488.8548822617"
[1] "iteration 6, logL = -43488.7814817402"
[1] "iteration 7, logL = -43488.7732577865"
[1] "iteration 8, logL = -43488.7731396411"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  9  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -41454.0653055455"
[1] "iteration 2, logL = -41387.280072851"
[1] "iteration 3, logL = -41292.6536675442"
[1] "iteration 4, logL = -41237.3987107637"
[1] "iteration 5, logL = -41204.8643468187"
[1] "iteration 6, logL = -41192.9533244173"
[1] "iteration 7, logL = -41191.3415818718"
[1] "iteration 8, logL = -41191.3093395944"
[1] "iteration 9, logL = -41191.3093251929"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  15  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -37917.8875216149"
[1] "iteration 2, logL = -37727.4078877034"
[1] "iteration 3, logL = -37703.5570621692"
[1] "iteration 4, logL = -37702.5348476369"
[1] "iteration 5, logL = -37702.5102296827"
[1] "iteration 6, logL = -37702.5098024294"
[1] "iteration 7, logL = -37702.5098022516"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  13  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -40576.3876660246"
[1] "iteration 2, logL = -40401.8207448634"
[1] "iteration 3, logL = -40312.0655349939"
[1] "iteration 4, logL = -40305.495643462"
[1] "iteration 5, logL = -40304.333996472"
[1] "iteration 6, logL = -40304.0223596794"
[1] "iteration 7, logL = -40303.9970821083"
[1] "iteration 8, logL = -40303.9968897847"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  13  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -43304.8870184651"
[1] "iteration 2, logL = -43146.6753908556"
[1] "iteration 3, logL = -43132.086334199"
[1] "iteration 4, logL = -43131.2988113079"
[1] "iteration 5, logL = -43131.0009175591"
[1] "iteration 6, logL = -43130.8725896412"
[1] "iteration 7, logL = -43130.8481113513"
[1] "iteration 8, logL = -43130.8471299011"
[1] "iteration 9, logL = -43130.8471280759"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:  10  columns are removed because the column sums are 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration 1, logL = -43988.6533780859"
[1] "step halving"
[1] "iteration 2, logL = -43749.4038505245"
[1] "iteration 3, logL = -43710.9081220285"
[1] "iteration 4, logL = -43709.6705232057"
[1] "iteration 5, logL = -43709.6536916466"
[1] "iteration 6, logL = -43709.6536587313"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>logldirmn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -37358.42 -42179.25 -39985.26 -40519.47 -43488.77 -41191.31 -37702.51
 [8] -40304.00 -43130.85 -43709.65</code></pre>
</div>
</div>
</section>
<section id="question-2." class="level2">
<h2 class="anchored" data-anchor-id="question-2.">Question 2.</h2>
<p>Read in the testing data. Use the estimated MLE for each digit from training data to predict handwriting digits for the testing data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"handwriting/optdigits.tes"</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(testdata)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>testDigitProb  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">dim</span>(testdata)[<span class="dv">1</span>], <span class="dv">10</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (dig <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  testDigitProb[, dig <span class="sc">+</span> <span class="dv">1</span>]  <span class="ot">&lt;-</span> <span class="fu">ddirmult</span>(testdata[, <span class="sc">-</span><span class="dv">65</span>], alphahat[dig <span class="sc">+</span> <span class="dv">1</span>, ], <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>testDigitProb  <span class="ot">&lt;-</span> testDigitProb <span class="sc">+</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="fu">log</span>(digitCount <span class="sc">/</span> <span class="fu">sum</span>(digitCount)), <span class="at">each =</span> <span class="fu">nrow</span>(testdata))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>digitPredicted  <span class="ot">&lt;-</span> <span class="fu">max.col</span>(testDigitProb) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(testdata[,<span class="dv">65</span>],digitPredicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   digitPredicted
      0   1   2   3   4   5   6   7   8   9
  0 174   0   0   0   4   0   0   0   0   0
  1   0 132  21   0   2   0   2   0  14  11
  2   0   9 151   2   0   1   1   1   8   4
  3   0   2   1 154   0   4   0   7   5  10
  4   0   2   0   0 173   0   1   2   2   1
  5   0   0   0   0   1 166   1   0   0  14
  6   0   6   0   0   2   1 170   0   2   0
  7   0   0   0   0  11   0   0 164   2   2
  8   0  22   1   0   1   1   1   1 134  13
  9   0   5   0   4   6   2   0   3   4 156</code></pre>
</div>
</div>
</section>
<section id="question-3." class="level2">
<h2 class="anchored" data-anchor-id="question-3.">Question 3.</h2>
<p>Comment on using gradient descent to obtain the MLE (instead of Newton’s method)? (You do not need to implement this.)</p>
<p>In this case the objective function that we are optimizing is the likelihood function for the Dirichlet-multinomial model. The main difference between the two optimization methods is that Newton’s method relies on both the first and second derivative while gradient descent only relies on the first derivative and a prespecified learning rate to control the step size. Due to the complexity of the likelihood function we’re working with it makes sense to use gradient descent to obtain the MLE for each handwritten digit.</p>
</section>
<section id="question-4." class="level2">
<h2 class="anchored" data-anchor-id="question-4.">Question 4.</h2>
<p>What is the advantage and disadvantage of using gradient descent instead of Newton’s method?</p>
<p>The advantage of using gradient descent is that you don’t have to calculate the second derivative of the function you’re optimizing. Gradient descent can help optimize likelihood functions that otherwise would be impossible or inconvenient to calculate the second derivative for.</p>
<p>The disadvantage of gradient descent is that it tends to converge slower than Newton’s method because the step size might not be either too small or too large. This slower convergence has negative implications on computation time and the resources required to find a global minimum.</p>
</section>
<section id="question-5." class="level2">
<h2 class="anchored" data-anchor-id="question-5.">Question 5.</h2>
<p>Do you think the current method is satisfactory for predicting handwriting digits? Do you know any other method(s) that can achieve a higher accuracy?</p>
<p>The current classifier does a pretty good job of classifying digits but it still falls short of modern computer vision models. Currently the best type of model for computer vision is a convolutional neural network due to its convolutional filters that can extract spatial patterns in images.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>